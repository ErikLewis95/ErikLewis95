(window.webpackJsonp=window.webpackJsonp||[]).push([[172],{38:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));function r(){return new Promise((function(t,e){var n=0,r=setInterval((function(){var o=document.querySelector("meta[name='csrf-token']");if(n+=1,o){clearInterval(r);var i=o.getAttribute("content");return t(i)}if(30===n)return clearInterval(r),Honeybadger.notify("Could not locate CSRF metatag ".concat(JSON.stringify(localStorage.current_user))),e(new Error("Could not locate CSRF meta tag on the page."))}),250)}))}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}var i=["headers","body","method","csrfToken"];function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===o(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}function l(t,e,n,r,o,i,c){try{var u=t[i](c),s=u.value}catch(a){return void n(a)}u.done?e(s):Promise.resolve(s).then(r,o)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function c(t){l(i,r,o,c,u,"next",t)}function u(t){l(i,r,o,c,u,"throw",t)}c(void 0)}))}}function b(t){return p.apply(this,arguments)}function p(){return p=f((function*(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.headers,o=e.body,c=e.method,s=void 0===c?"GET":c,l=e.csrfToken,f=void 0===l?yield r():l,b=a(e,i),p={body:o&&"string"!==typeof o?JSON.stringify(o):o},y=u(u({method:s,headers:u({Accept:"application/json","X-CSRF-Token":f,"Content-Type":"application/json"},n),credentials:"same-origin"},p),b);return fetch(t,y)})),p.apply(this,arguments)}},746:function(t,e,n){"use strict";n.r(e),n.d(e,"COMMENT_SUBSCRIPTION_TYPE",(function(){return d})),n.d(e,"CommentSubscription",(function(){return m})),n.d(e,"getCommentSubscriptionStatus",(function(){return g})),n.d(e,"setCommentSubscriptionStatus",(function(){return w}));var r=n(0),o=n(1),i=n.n(o),c=n(4);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,c,u=[],s=!0,a=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(u.push(r.value),u.length!==e);s=!0);}catch(l){a=!0,o=l}finally{try{if(!s&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(a)throw o}}return u}}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(o=r.key,i=void 0,i=function(t,e){if("object"!==u(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===u(i)?i:String(i)),r)}var o,i}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function b(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=y(t);if(e){var o=y(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p(this,n)}}function p(t,e){if(e&&("object"===u(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var d=Object.freeze({ALL:"all_comments",TOP:"top_level_comments",AUTHOR:"only_author_comments",NOT_SUBSCRIBED:"not_subscribed"}),m=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(u,t);var e,n,o,i=b(u);function u(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u);var n=t.subscriptionType;(e=i.call(this,t)).commentSubscriptionClick=function(t){e.setState({subscriptionType:t.target.value})};var r=n&&(n.length>0&&n)!==d.NOT_SUBSCRIBED,o={subscriptionType:r?n:d.ALL,subscribed:r,showOptions:!1};return e.state=o,e}return e=u,(n=[{key:"render",value:function(){var t=this,e=this.state,n=e.subscriptionType,o=e.subscribed,i=this.props,u=i.onSubscribe,s=i.onUnsubscribe,a=i.positionType,l=void 0===a?"relative":a,f=i.isLoggedIn;return Object(r.h)("div",{className:l},Object(r.h)(c.ButtonGroup,{labelText:"Comment subscription options",ref:function(e){t.buttonGroupElement=e}},Object(r.h)(c.Button,{variant:"outlined","data-tracking-name":"comment_subscription_toggle",onClick:function(e){f?(o?(s(d.NOT_SUBSCRIBED),t.setState({subscriptionType:d.ALL})):u(n),t.setState({subscribed:!o})):showLoginModal({referring_source:"comments",trigger:"comment_subscription"})}},o?"Unsubscribe":"Subscribe"),o?Object(r.h)(c.Button,{id:"subscription-settings-btn","data-testid":"subscription-settings","data-tracking-name":"comment_subscription_settings",variant:"outlined",icon:function(){return Object(r.h)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",role:"img","aria-labelledby":"ai2ols8ka2ohfp0z568lj68ic2du21s",className:"crayons-icon"},Object(r.h)("title",{id:"ai2ols8ka2ohfp0z568lj68ic2du21s"},"Preferences"),Object(r.h)("path",{d:"M12 1l9.5 5.5v11L12 23l-9.5-5.5v-11L12 1zm0 2.311L4.5 7.653v8.694l7.5 4.342 7.5-4.342V7.653L12 3.311zM12 16a4 4 0 110-8 4 4 0 010 8zm0-2a2 2 0 100-4 2 2 0 000 4z"}))},contentType:"icon"}):null),o&&Object(r.h)(c.Dropdown,{triggerButtonId:"subscription-settings-btn",dropdownContentId:"subscription-settings-dropdown",dropdownContentCloseButtonId:"subscription-settings-done-btn","data-repositioning-dropdown":"true","data-testid":"subscriptions-panel",className:"right-0 p-4 s:left-auto".concat("relative"===l?" w-full":""),ref:function(e){t.dropdownElement=e},onOpen:function(){return t.setState({showOptions:!0})},onClose:function(){return t.setState({showOptions:!1})}},Object(r.h)("div",{className:"crayons-fields mb-5"},Object(r.h)(c.FormField,{variant:"radio"},Object(r.h)(c.RadioButton,{id:"subscribe-all",name:"subscribe_comments",value:d.ALL,checked:n===d.ALL,onClick:this.commentSubscriptionClick}),Object(r.h)("label",{htmlFor:"subscribe-all",className:"crayons-field__label"},"All comments",Object(r.h)("p",{className:"crayons-field__description"},"You\u2019ll receive notifications for all new comments."))),Object(r.h)(c.FormField,{variant:"radio"},Object(r.h)(c.RadioButton,{id:"subscribe-toplevel",name:"subscribe_comments",value:d.TOP,onClick:this.commentSubscriptionClick,checked:n===d.TOP}),Object(r.h)("label",{htmlFor:"subscribe-toplevel",className:"crayons-field__label"},"Top-level comments",Object(r.h)("p",{className:"crayons-field__description"},"You\u2019ll receive notifications only for all new top-level comments."))),Object(r.h)(c.FormField,{variant:"radio"},Object(r.h)(c.RadioButton,{id:"subscribe-author",name:"subscribe_comments",value:d.AUTHOR,onClick:this.commentSubscriptionClick,checked:n===d.AUTHOR}),Object(r.h)("label",{htmlFor:"subscribe-author",className:"crayons-field__label"},"Post author comments",Object(r.h)("p",{className:"crayons-field__description"},"You\u2019ll receive notifications only if post author sends a new comment.")))),Object(r.h)(c.Button,{id:"subscription-settings-done-btn",className:"w-100",onClick:function(){u(t.state.subscriptionType)}},"Done")))}}])&&l(e.prototype,n),o&&l(e,o),Object.defineProperty(e,"prototype",{writable:!1}),u}(r.Component);m.displayName="CommentSubscription",m.propTypes={positionType:i.a.oneOf(["absolute","relative","static"]).isRequired,onSubscribe:i.a.func.isRequired,onUnsubscribe:i.a.func.isRequired,subscriptionType:i.a.oneOf(Object.entries(d).map((function(t){return s(t,2)[1]}))).isRequired,isLoggedIn:i.a.bool.isRequired};var h=n(38);function v(t,e,n,r,o,i,c){try{var u=t[i](c),s=u.value}catch(a){return void n(a)}u.done?e(s):Promise.resolve(s).then(r,o)}function O(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function c(t){v(i,r,o,c,u,"next",t)}function u(t){v(i,r,o,c,u,"throw",t)}c(void 0)}))}}function g(t){return j.apply(this,arguments)}function j(){return(j=O((function*(t){try{var e=yield Object(h.a)("/notification_subscriptions/Article/".concat(t));return yield e.json()}catch(n){return new Error("An error occurred, please try again")}}))).apply(this,arguments)}function w(t,e){return S.apply(this,arguments)}function S(){return(S=O((function*(t,e){var n;try{var r=yield Object(h.a)("/notification_subscriptions/Article/".concat(t),{method:"POST",body:JSON.stringify({config:e})}),o=yield r.json();if("boolean"!==typeof o)return n="An error occurred, please try again";n="You have been unsubscribed from comments for this post",o&&(n="You have been subscribed to ".concat(e.replace(/_/g," ")))}catch(i){n="An error occurred, please try again"}return n}))).apply(this,arguments)}}}]);
//# sourceMappingURL=172-86001bae560cc8b224ef.chunk.js.map